<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width={{.Width}}, height={{.Height}}">
    <title>Calvin Calendar</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --white: #ffffff;
            --black: #343a40;
            --red: #dc3545;
            --grey: #6c757d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: {{.Width}}px;
            height: {{.Height}}px;
            overflow: hidden;
            background: var(--white);
            font-family: 'IBM Plex Sans', -apple-system, sans-serif;
            color: var(--black);
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* Header with month name and weather */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 24px;
            border-bottom: 2px solid var(--grey);
            flex-shrink: 0;
        }

        .month-title {
            font-size: 28px;
            font-weight: 600;
            color: var(--black);
        }

        .generated-at {
            font-size: 12px;
            color: var(--grey);
            font-weight: 400;
        }

        /* Day names header */
        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            border-bottom: 2px solid var(--grey);
            flex-shrink: 0;
        }

        .weekday {
            padding: 10px 12px;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--black);
            text-align: left;
            border-right: 1px solid var(--grey);
        }

        .weekday:last-child {
            border-right: none;
        }

        /* Calendar grid */
        .calendar {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .week {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            flex: 1;
            border-bottom: 1px solid var(--grey);
        }

        .week:last-child {
            border-bottom: none;
        }

        .day {
            border-right: 1px solid var(--grey);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 0;
            background: var(--white);
        }

        .day:last-child {
            border-right: none;
        }

        .day.other-month .day-num {
            color: var(--grey);
        }

        .day.other-month .events {
            color: var(--grey);
        }

        .day-header {
            padding: 8px 10px 4px;
            flex-shrink: 0;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .day-num {
            font-size: 18px;
            font-weight: 500;
            color: var(--black);
            width: 32px;
            height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .day-temps {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 2px;
            font-size: 11px;
            font-weight: 500;
        }

        .day-temp {
            color: var(--black);
        }

        .night-temp {
            color: var(--grey);
        }

        /* TODAY: Red circle - the key accent! */
        .day.today .day-num {
            background: var(--red);
            color: var(--white);
            border-radius: 50%;
            font-weight: 600;
        }

        .day-month {
            font-size: 12px;
            color: var(--black);
            margin-left: 4px;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Events */
        .events {
            flex: 1;
            overflow: hidden;
            padding: 0 6px 6px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .event {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 3px 6px;
            font-size: 13px;
            line-height: 1.3;
            min-height: 22px;
            overflow: hidden;
        }

        /* Timed events */
        .event.timed {
            background: transparent;
        }

        .event.timed .event-time {
            font-size: 12px;
            color: var(--red);
            flex-shrink: 0;
            font-weight: 500;
        }

        /* All-day events: black background bar */
        .event.all-day {
            background: var(--black);
            color: var(--white);
            border-radius: 3px;
            font-weight: 500;
        }

        /* Past day events: grey */
        .day.past .event.timed .event-time,
        .day.past .event.timed .event-title {
            color: var(--grey);
        }

        .day.past .event.all-day {
            background: var(--grey);
        }

        .event-title {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="month-title">{{.MonthName}} {{.Year}}</div>
            <div class="generated-at">Generated: {{.GeneratedAt}}</div>
        </div>

        <!-- Weekday headers -->
        <div class="weekdays">
            <div class="weekday">Mon</div>
            <div class="weekday">Tue</div>
            <div class="weekday">Wed</div>
            <div class="weekday">Thu</div>
            <div class="weekday">Fri</div>
            <div class="weekday">Sat</div>
            <div class="weekday">Sun</div>
        </div>

        <!-- Calendar grid -->
        <div class="calendar">
            {{range .Weeks}}
            <div class="week">
                {{range .Days}}
                <div class="day{{if not .IsCurrentMonth}} other-month{{end}}{{if .IsToday}} today{{end}}{{if .IsPast}} past{{end}}">
                    <div class="day-header">
                        <div>
                            <span class="day-num">{{.DayNum}}</span>
                            {{if eq .DayNum "1"}}<span class="day-month">{{.MonthShort}}</span>{{end}}
                        </div>
                        {{if .DayTemp}}
                        <div class="day-temps">
                            <span class="day-temp">{{.DayTemp}}</span>
                            <span class="night-temp">{{.NightTemp}}</span>
                        </div>
                        {{end}}
                    </div>
                    <div class="events">
                        {{range .Events}}
                        {{if .AllDay}}
                        <div class="event all-day">
                            <span class="event-title">{{.Summary}}</span>
                        </div>
                        {{else}}
                        <div class="event timed">
                            <span class="event-time">{{.Time}}</span>
                            <span class="event-title">{{.Summary}}</span>
                        </div>
                        {{end}}
                        {{end}}
                    </div>
                </div>
                {{end}}
            </div>
            {{end}}
        </div>
    </div>
</body>
</html>
